
---
# تحلیل آستانه (Threshold) برای تابع S-curve در LSH

این سند به بررسی **آستانه شباهت ژاکارد (Jaccard similarity)** می‌پردازد که در آن، احتمال انتخاب دو سند به عنوان یک جفت کاندید در تکنیک Locality-Sensitive Hashing (LSH) برای امضاهای Minhash برابر با 0.5 می‌شود. تابع **S-curve** به شکل $1 - (1 - s^r)^b$ این احتمال را مدل می‌کند، جایی که **$s$** شباهت ژاکارد، **$b$** تعداد باندها (bands) و **$r$** تعداد سطرها (rows) در هر باند است.

### محاسبه آستانه دقیق

برای یافتن آستانه دقیق $s$ که در آن احتمال برابر با 0.5 می‌شود، معادله $1 - (1 - s^r)^b = \frac{1}{2}$ را حل می‌کنیم:

1.  $\frac{1}{2} = (1 - s^r)^b$
2.  با گرفتن ریشه $b$-ام از طرفین:
    $$(\frac{1}{2})^{1/b} = 1 - s^r$$
3.  با جابه‌جایی $s^r$:
    $$s^r = 1 - (\frac{1}{2})^{1/b}$$
4.  در نهایت، با گرفتن ریشه $r$-ام از طرفین، فرمول آستانه دقیق $s$ به دست می‌آید:
    $$s = (1 - (\frac{1}{2})^{1/b})^{1/r}$$

---

### مقایسه آستانه دقیق و تقریبی

در ادامه، محاسبات را برای هر یک از جفت‌های $(r, b)$ مشخص شده در تمرین 3.4.1 انجام داده و نتایج را با تخمین ساده $(1/b)^{1/r}$ مقایسه می‌کنیم:

---

#### حالت اول: $r = 3$ و $b = 10$

* **آستانه دقیق:**
    $s = (1 - (\frac{1}{2})^{1/10})^{1/3}$
    $s \approx (1 - 0.93303)^{1/3}$
    $s \approx (0.06697)^{1/3}$
    $s \approx \mathbf{0.406}$

* **آستانه تقریبی:**
    $s \approx (1/10)^{1/3}$
    $s \approx (0.1)^{1/3}$
    $s \approx \mathbf{0.464}$

* **مقایسه:** آستانه دقیق ($0.406$) **کمتر** از آستانه تقریبی ($0.464$) است.

---

#### حالت دوم: $r = 6$ و $b = 20$

* **آستانه دقیق:**
    $s = (1 - (\frac{1}{2})^{1/20})^{1/6}$
    $s \approx (1 - 0.96594)^{1/6}$
    $s \approx (0.03406)^{1/6}$
    $s \approx \mathbf{0.522}$

* **آستانه تقریبی:**
    $s \approx (1/20)^{1/6}$
    $s \approx (0.05)^{1/6}$
    $s \approx \mathbf{0.546}$

* **مقایسه:** آستانه دقیق ($0.522$) **کمتر** از آستانه تقریبی ($0.546$) است. لازم به ذکر است، در Example 3.11 منابع بیان می‌کنند که برای $b=20$ و $r=5$، آستانه کمی بیشتر از 0.5 است. آستانه دقیق محاسبه شده برای این حالت ($r=5, b=20$) برابر با $(1 - (1/2)^{1/20})^{1/5} \approx (1 - 0.96594)^{1/5} \approx (0.03406)^{1/5} \approx 0.506$ است که با این توضیحات سازگار است.

---

#### حالت سوم: $r = 5$ و $b = 50$

* **آستانه دقیق:**
    $s = (1 - (\frac{1}{2})^{1/50})^{1/5}$
    $s \approx (1 - 0.98614)^{1/5}$
    $s \approx (0.01386)^{1/5}$
    $s \approx \mathbf{0.435}$

* **آستانه تقریبی:**
    $s \approx (1/50)^{1/5}$
    $s \approx (0.02)^{1/5}$
    $s \approx \mathbf{0.457}$

* **مقایسه:** آستانه دقیق ($0.435$) **کمتر** از آستانه تقریبی ($0.457$) است.

---

### نتیجه‌گیری نهایی

برای هر سه جفت $(r, b)$ بررسی شده، آستانه دقیق شباهت که در آن احتمال کاندید شدن به $0.5$ می‌رسد، **همواره کمتر از** آستانه تقریبی $(1/b)^{1/r}$ است. این نشان می‌دهد که تخمین ساده $(1/b)^{1/r}$ تمایل دارد که آستانه واقعی را، یعنی جایی که احتمال کاندید شدن دقیقاً $0.5$ است، **بیش‌برآورد (overestimate)** کند.

با این حال، همانطور که منابع مربوط به LSH اشاره می‌کنند، این تخمین $(1/b)^{1/r}$ به عنوان یک نقطه تقریب "تقریباً" در جایی که منحنی S بیشترین شیب را دارد، مفید است. این فرمول به عنوان یک راهنمای عملی برای انتخاب پارامترهای $r$ و $b$ بر اساس آستانه شباهت مطلوب $t$ (که در آن $t \approx (1/b)^{1/r}$) ارائه می‌شود و به ما کمک می‌کند تا به سرعت ترکیب‌های مناسب $r$ و $b$ را برای یک سطح شباهت هدف، شناسایی کنیم.




---
## ترجمه و حل تمرین 3.4.3: تقریب منحنی S در شرایط خاص

این تمرین از شما می‌خواهد که با استفاده از تکنیک‌های توضیح داده شده در **بخش 1.3.5** (که احتمالاً مربوط به تقریب توابع با استفاده از بسط دوجمله‌ای یا بسط تیلور/مک‌لورن است)، تابع **S-curve** به شکل $1 - (1 - s^r)^b$ را در حالتی که $s^r$ بسیار کوچک باشد، تقریب بزنید.

### ترجمه سوال:

**"با استفاده از تکنیک‌های توضیح داده شده در بخش 1.3.5، منحنی S، $1 - (1 - s^r)^b$ را در حالتی که $s^r$ بسیار کوچک است، تقریب بزنید."**

### رویکرد حل:

هنگامی که $s^r$ بسیار کوچک است، یعنی $s^r \ll 1$， می‌توانیم از تقریب‌های دوجمله‌ای (binomial approximation) استفاده کنیم. فرمول کلی بسط دوجمله‌ای برای $(1+x)^n$ وقتی $x$ کوچک است، به صورت $(1+x)^n \approx 1 + nx$ است. اگر $x$ بسیار کوچک و منفی باشد، یعنی $(1-x)^n \approx 1 - nx$.

در اینجا، ما $(1 - s^r)^b$ را داریم. می‌توانیم $s^r$ را به عنوان $x$ در نظر بگیریم. از آنجا که سوال می‌گوید $s^r$ بسیار کوچک است، می‌توانیم این تقریب را اعمال کنیم:

$(1 - s^r)^b \approx 1 - b \cdot s^r$

حالا این تقریب را در فرمول اصلی S-curve جایگزین می‌کنیم:

$1 - (1 - s^r)^b \approx 1 - (1 - b \cdot s^r)$

$1 - (1 - b \cdot s^r) = 1 - 1 + b \cdot s^r$

$= b \cdot s^r$

### نتیجه‌گیری:

بنابراین، وقتی $s^r$ بسیار کوچک است، تابع S-curve (احتمال کاندید شدن) را می‌توان با تقریب ساده‌تر **$b \cdot s^r$** بیان کرد.

این تقریب نشان می‌دهد که برای مقادیر بسیار کوچک شباهت $s$ (به شرطی که $r$ به اندازه‌ای بزرگ نباشد که $s^r$ را دوباره بزرگ کند)، احتمال کاندید شدن تقریباً به صورت خطی با $s^r$ افزایش می‌یابد و به تعداد باندها ($b$) وابسته است. این موضوع به خصوص در فهم رفتار تابع S-curve در بخش‌های ابتدایی (شباهت‌های بسیار کم) آن مفید است.
---
مطابق با تمرین 3.4.3 و بخش‌های مرتبط در منابع، هدف این است که منحنی S شکل **`1 - (1 - s^r)^b`** را زمانی که **`s^r` بسیار کوچک** است، با استفاده از روش‌های توضیح داده شده در بخش 1.3.5 تقریب بزنیم.

تابع `1 - (1 - s^r)^b` در تکنیک Locality-Sensitive Hashing (LSH) برای امضاهای مین هش (Minhash Signatures) بیانگر **احتمال اینکه دو سند با شباهت ژاکارد `s` به عنوان یک جفت کاندید در نظر گرفته شوند** است. در این فرمول، `b` تعداد نوارها (bands) و `r` تعداد سطرها (rows) در هر نوار است.

بخش 1.3.5 منابع، تکنیک‌هایی را برای تقریب عبارات توانی مانند `(1 + a)^b` یا `(1 - a)^b` زمانی که `a` کوچک است (و `b` می‌تواند بزرگ باشد) توضیح می‌دهد. بر اساس این بخش، زمانی که `a` یک عدد کوچک (مثبت یا منفی) است و `b` بزرگ است، **`(1 + a)^b` تقریباً برابر با `e^{ab}`** است. به طور مشابه، زمانی که `a` کوچک و مثبت است و `b` بزرگ است، **`(1 - a)^b` تقریباً برابر با `e^{-ab}`** است. این تقریب بر اساس حدی مانند `(1 - 1/x)^x` بنا شده است که وقتی `x` به بی‌نهایت میل می‌کند، به `1/e` نزدیک می‌شود.

در فرمول منحنی S، عبارت `(1 - s^r)^b` وجود دارد. این عبارت دقیقاً شکل `(1 - a)^b` را دارد، که در اینجا `a` برابر با `s^r` است. فرض تمرین این است که `s^r` بسیار کوچک است. بنابراین، ما می‌توانیم از تقریبی که در بخش 1.3.5 توضیح داده شده است، استفاده کنیم:

**`(1 - s^r)^b ≈ e^{-(s^r)b} = e^{-bs^r}`**

با جایگزینی این تقریب در فرمول اصلی منحنی S، تقریب منحنی S را زمانی که `s^r` بسیار کوچک است، به دست می‌آوریم:

**`1 - (1 - s^r)^b ≈ 1 - e^{-bs^r}`**

این تقریب نشان می‌دهد که برای مقادیر کوچک شباهت `s` (به گونه‌ای که `s^r` کوچک باشد)، احتمال کاندید شدن جفت به صورت نمایی بر حسب `bs^r` افزایش می‌یابد.

توجه داشته باشید که اگر حاصل‌ضرب `bs^r` نیز بسیار کوچک باشد، می‌توان از بسط تیلور تابع `e^x` حول `x=0` (که برای `x` کوچک، `e^x ≈ 1 + x` است) استفاده کرد. در این حالت، با قرار دادن `x = -bs^r`، خواهیم داشت:
`e^{-bs^r} ≈ 1 + (-bs^r) = 1 - bs^r`
که منجر به یک تقریب ساده‌تر برای منحنی S می‌شود:
`1 - (1 - bs^r) = bs^r`
اما تقریب اصلی و دقیق‌تر بر اساس تکنیک بخش 1.3.5 که برای `b` بزرگ نیز کاربرد دارد، همان **`1 - e^{-bs^r}`** است.