### **تمرین‌های صفحه 77، بخش 3.1: تشخیص تشابه (Similarity Detection)**

#### **3.1.1**
فرض کنید که شما از تکنیک‌های Minhash استفاده می‌کنید و از 20 تابع هش (hash function) برای هر مجموعه استفاده می‌کنید. دو مجموعه A و B را در نظر بگیرید که هر دو دارای 100 عنصر هستند.
* الف) اگر Jaccard Similarity (تشابه جاکارد) بین A و B دقیقاً 0.5 باشد، احتمال اینکه تخمین Minhash شما دقیقاً 0.5 باشد چقدر است؟
* ب) اگر تشابه جاکارد بین A و B دقیقاً 0.5 باشد، احتمال اینکه تخمین Minhash شما کمتر از 0.4 یا بیشتر از 0.6 باشد چقدر است؟

**پاسخ:**

* **الف)**
    تعداد توابع هش $k = 20$.
    تشابه جاکارد $s = 0.5$.
    برای اینکه تخمین Minhash دقیقاً 0.5 باشد، تعداد توابع هشی که Minhash آنها یکسان است باید $X = 0.5 \times 20 = 10$ باشد.
    $X$ از توزیع دوجمله‌ای $B(n=20, p=0.5)$ پیروی می‌کند.
    $$P(X=10) = \binom{20}{10} (0.5)^{10} (0.5)^{10} = \binom{20}{10} (0.5)^{20}$$   $$\binom{20}{10} = 184756$$   $$(0.5)^{20} \approx 0.000000953674$$   $$P(X=10) \approx 184756 \times 0.000000953674 \approx 0.176197$$

* **ب)**
    ما به دنبال $P(\frac{X}{20} < 0.4 \text{ یا } \frac{X}{20} > 0.6)$ هستیم که معادل $P(X < 8 \text{ یا } X > 12)$ یا $P(X \le 7 \text{ یا } X \ge 13)$ است.
    $$P(X \le 7) = \sum_{i=0}^{7} \binom{20}{i} (0.5)^{20} = (1+20+190+1140+4845+15504+38760+77520) \times (0.5)^{20}$$   $$P(X \le 7) = 137980 \times (0.5)^{20} \approx 0.131589$$
    به دلیل تقارن توزیع برای $p=0.5$:
    $$P(X \ge 13) = P(X \le 7) \approx 0.131589$$   $$P(X < 8 \text{ یا } X > 12) = P(X \le 7) + P(X \ge 13) \approx 0.131589 + 0.131589 \approx 0.263178$$

#### **3.1.2**
فرض کنید که شما از تکنیک‌های Minhash استفاده می‌کنید و از 20 تابع هش برای هر مجموعه استفاده می‌کنید. فرض کنید یک دنباله از 20 پرتاب سکه مستقل دارید و احتمال اینکه سکه رو بیاید 0.5 است.
* الف) احتمال اینکه دقیقاً 10 بار سکه رو بیاید چقدر است؟
* ب) احتمال اینکه کمتر از 8 یا بیشتر از 12 بار سکه رو بیاید چقدر است؟
* ج) توضیح دهید که چگونه این سوال با سوال 3.1.1 مرتبط است.

**پاسخ:**

* **الف)**
    اگر $Y$ تعداد دفعات رو آمدن سکه باشد، $Y \sim B(n=20, p=0.5)$.
    $$P(Y=10) = \binom{20}{10} (0.5)^{10} (0.5)^{10} = \binom{20}{10} (0.5)^{20} \approx 0.176197$$

* **ب)**
    $$P(Y < 8 \text{ یا } Y > 12) = P(Y \le 7 \text{ یا } Y \ge 13) \approx 0.263178$$

* **ج)**
    هر دو سوال 3.1.1 و 3.1.2 از نظر ریاضی، مدل‌سازی یکسانی از توزیع دوجمله‌ای $B(n=20, p=0.5)$ را نشان می‌دهند. در 3.1.1، "موفقیت" به معنای تطابق Minhash با احتمال Jaccard Similarity (0.5) است. در 3.1.2، "موفقیت" به معنای رو آمدن سکه با احتمال 0.5 است. هر دو سناریو منجر به یک توزیع احتمال و محاسبات یکسان می‌شوند.

#### **3.1.3**
فرض کنید از طرح LSH (Locality-Sensitive Hashing) استفاده می‌کنید که 25 امضای Minhash را به 5 باند (bands) با 5 ردیف (rows) در هر باند تقسیم می‌کند. فرض کنید که حداقل یکی از جفت‌هایی که امضای Minhash آنها در همه ردیف‌های حداقل یک باند یکسان باشد را به عنوان یک "کاندید" شناسایی کنید.
* الف) احتمال شناسایی یک جفت با تشابه جاکارد 0.8 به عنوان کاندید چقدر است؟
* ب) احتمال شناسایی یک جفت با تشابه جاکارد 0.3 به عنوان کاندید چقدر است؟

**پاسخ:**

* **الف)**
    تعداد باندها $b = 5$.
    تعداد ردیف‌ها در هر باند $r = 5$.
    شباهت جاکارد $s = 0.8$.
    فرمول احتمال شناسایی کاندید: $f(s) = 1 - (1 - s^r)^b$.
    $$f(0.8) = 1 - (1 - (0.8)^5)^5$$   $$(0.8)^5 = 0.32768$$   $$f(0.8) = 1 - (1 - 0.32768)^5 = 1 - (0.67232)^5 \approx 1 - 0.135213 \approx 0.864787$$

* **ب)**
    شباهت جاکارد $s = 0.3$.
    $$f(0.3) = 1 - (1 - (0.3)^5)^5$$   $$(0.3)^5 = 0.00243$$   $$f(0.3) = 1 - (1 - 0.00243)^5 = 1 - (0.99757)^5 \approx 1 - 0.98788 \approx 0.01212$$

---
